{% extends "core.twig" %}

{% block content %}

<span class="label">The settings page is not implemented yet</span>

<div class="row">

    <div class="span6">
        <div class="form-horizontal">
            <fieldset>
                <legend>{% trans "Account Settings" %}</legend>

                <div class="control-group">
                    <label class="control-label" for="email">{% trans "E-Mail" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="email" value="{{ user.email }}">
                        <p class="help-block">{% trans "This is the email address which you used to sign up." %}</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="pwd">{% trans "Current Password" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="pwd">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="pwd">{% trans "New Password" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="pwd">
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="pwd2">{% trans "New Password (repeat)" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="pwd2">
                        <p class="help-block">{% trans "If you don't feel like changing your password, just leave the password fields blank for now." %}</p>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" type="submit">{% trans "Save changes" %}</button>
                    <button class="btn">{% trans "Undo changes" %}</button>
                </div>
            </fieldset>

        </div>

    </div>
    <div class="span6">
        <div class="form-horizontal">
            <fieldset>
                <legend>{% trans "User Profile" %}</legend>

                <div class="control-group">
                    <label class="control-label" for="name">{% trans "Name" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="name" placeholder="" value="{{ user.name }}">
                        <p class="help-block">{% trans "Filling out your profile is optional. If you do, you can display these information below the charts you publish." %}</p>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="website">{% trans "Website" %}</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="website" placeholder="http://" value="{{ user.website }}">
                        <p class="help-block">{% trans "Add a website that contains more information about you (e.g. your blog). Optionally you can display these information below you published charts." %}</p>
                    </div>
                </div>
                <div class="control-group">
                    <label class="control-label" for="socialmedia">Twitter/Facebook/etc</label>
                    <div class="controls">
                        <input type="text" class="input-xlarge" id="socialmedia" placeholder="http://twitter.com/" value="{{ user.smProfile }}">
                        <p class="help-block">{% trans "Enter the link to your favorite social media profile (e.g. Twitter)." %}</p>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" type="submit">{% trans "Save changes" %}</button>
                    <button class="btn">{% trans "Undo changes" %}</button>
                </div>
            </fieldset>

        </div>

    </div>
</div>
<div class="row" style="margin-top:4em">
    <div class="span6">

        <div class="form-horizontal">
            <fieldset>

                {% if user.isAbleToPublish %}

                <legend>{% trans "Account Status" %} <span class="label label-success">{% trans "activated" %}</span></legend>

                <p>Your account has been activated, and you are able to create and publish charts.</p>

                {% elseif user.role == 'pending' %}

                <legend>{% trans "Account Status" %} <span class="label label-warning">{% trans "pending" %}</span></legend>

                <p>{% trans "Your account is pending because your email address has not been activated, yet. You can create charts, but they will not be visible for anybody else." %}</p>

                <p><em>{% trans "Having trouble with the account activation?" %}</em></p>

                <ul class="options">
                    <li><i class="icon-chevron-right"></i> {{ "Maybe the email has been catched by your email providers spam filter. Please check the spam folder for the last activation email we sent on <strong>%DATE%</strong>." | trans | replace({'%DATE%': activation_email_date }) | raw }}</li>

                    <li><i class="icon-chevron-right"></i> <a class="btn" href="#" id="resend-activation-link">{% trans "Re-send activation link" %}</a></li>

                    <li><i class="icon-chevron-right"></i> {{ "Or, <a href='mailto:%ADMINMAIL%'>contact us</a> to find other ways to activate your account." | trans | replace({'%ADMINMAIL%': ADMIN_EMAIL }) | raw }}</li>
                </ul>

                {% endif %}

            </fieldset>
        </div>
    </div>
    <div class="span6">
        <div class="form-horizontal">
             <fieldset>
                <legend>{% trans "Delete Datawrapper Account" %}</legend>

                        <p>{% trans "This will remove your Datawrapper account and all the charts you created so far. They won't be visible in places where you embedded them." %}</p>
                        <button class="btn btn-danger">{% trans "Yes, delete my account!" %}</button>

             </fieldset>
            <p></p>
        </div>
    </div>
</div>
<script type="text/javascript">

$(function() {
    $('#resend-activation-link').click(function(e) {
        e.preventDefault();
        $.ajax({
            url: '/api/account/resend-activation',
            type: 'POST',
            dataType: 'json',
            success: function(res) {
                console.log(res);
                if (res.status == 'ok') {
                    DW.logMessage(res.data, $(e.target).parent());
                } else {
                    DW.logError(res.message, $(e.target).parent());
                }
            }
        });
    });
});

</script>

{{ parent() }}
{% endblock %}